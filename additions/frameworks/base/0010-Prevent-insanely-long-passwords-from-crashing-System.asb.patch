From 5d4d8d2d1bdb527908c6fee9f77c0a82df9a821a Mon Sep 17 00:00:00 2001
From: Adrian Roos <roosa@google.com>
Date: Sat, 12 Sep 2015 15:34:36 +0200
Subject: [PATCH 10/46] Prevent insanely long passwords from crashing SystemUI

CVE-2015-3860: Elevation of Privilege Vulnerability in Lockscreen

Bug: 22214934
Change-Id: I32e238e53ac4b6dd0ae6de226b98894c495b256f
---
 packages/Keyguard/res/layout/keyguard_password_view.xml | 1 +
 1 file changed, 1 insertion(+)

diff --git a/packages/Keyguard/res/layout/keyguard_password_view.xml b/packages/Keyguard/res/layout/keyguard_password_view.xml
index d8012bf..66301e8 100644
--- a/packages/Keyguard/res/layout/keyguard_password_view.xml
+++ b/packages/Keyguard/res/layout/keyguard_password_view.xml
@@ -72,6 +72,7 @@
                  android:textAppearance="?android:attr/textAppearanceMedium"
                  android:textColor="#ffffffff"
                  android:imeOptions="flagForceAscii|actionDone"
+                 android:maxLength="500"
                  />
 
              <ImageView android:id="@+id/switch_ime_button"
-- 
2.7.4

