From a6504fdcad785318a180f04a220542803ae4b2a6 Mon Sep 17 00:00:00 2001
From: Josh Gao <jmgao@google.com>
Date: Mon, 21 Mar 2016 18:32:17 -0700
Subject: [PATCH 09/20] Don't demangle symbol names. DO NOT MERGE

Bug: http://b/27299236
Change-Id: I80524d8d5df9c5abea8c6db8ded965a5dfa3d607
(cherry picked from commit a183654b820447e6bd9980413e1f7ff5b89f875b)
---
 debuggerd/tombstone.c | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)

diff --git a/debuggerd/tombstone.c b/debuggerd/tombstone.c
index 442e163..2921350 100644
--- a/debuggerd/tombstone.c
+++ b/debuggerd/tombstone.c
@@ -32,7 +32,6 @@
 #include <log/logger.h>
 #include <cutils/properties.h>
 
-#include <corkscrew/demangle.h>
 #include <corkscrew/backtrace.h>
 
 #include <sys/socket.h>
@@ -260,8 +259,7 @@ static void dump_stack_segment(const ptrace_context_t* context, log_t* log, pid_
         find_symbol_ptrace(context, stack_content, &mi, &symbol);
 
         if (symbol) {
-            char* demangled_name = demangle_symbol_name(symbol->name);
-            const char* symbol_name = demangled_name ? demangled_name : symbol->name;
+            const char* symbol_name = symbol->name;
             uint32_t offset = stack_content - (mi->start + symbol->start);
             if (!i && label >= 0) {
                 if (offset) {
@@ -280,7 +278,6 @@ static void dump_stack_segment(const ptrace_context_t* context, log_t* log, pid_
                             *sp, stack_content, mi ? mi->name : "", symbol_name);
                 }
             }
-            free(demangled_name);
         } else {
             if (!i && label >= 0) {
                 _LOG(log, scopeFlags, "    #%02d  %08x  %08x  %s\n",
-- 
2.7.4

