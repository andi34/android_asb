From 6d9c04acb6c0786c9b354b245a75875214c26b71 Mon Sep 17 00:00:00 2001
From: Wei Jia <wjia@google.com>
Date: Thu, 20 Aug 2015 16:25:04 -0700
Subject: [PATCH 02/15] Sonivox: make sure waveIndex is valid in Parse_rgn() in
 eas_mdls.c.

Bug: 23335715
Change-Id: I4a5522c46dcda9285db1f830337aa2642ddc4fd1
(cherry picked from commit 99e0e2e2c1fd0f895b6d4bdf0a85798cf044218e)
---
 arm-wt-22k/lib_src/eas_mdls.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/arm-wt-22k/lib_src/eas_mdls.c b/arm-wt-22k/lib_src/eas_mdls.c
index 51cce70..d66c734 100644
--- a/arm-wt-22k/lib_src/eas_mdls.c
+++ b/arm-wt-22k/lib_src/eas_mdls.c
@@ -1676,6 +1676,10 @@ static EAS_RESULT Parse_rgn (SDLS_SYNTHESIZER_DATA *pDLSData, EAS_I32 pos, EAS_I
     /* parse wlnk chunk */
     if ((result = Parse_wlnk(pDLSData, wlnkPos, &waveIndex)) != EAS_SUCCESS)
         return result;
+    if (waveIndex >= pDLSData->waveCount)
+    {
+        return EAS_FAILURE;
+    }
     pWsmp = &pDLSData->wsmpData[waveIndex];
 
     /* if there is any articulation data, parse it */
-- 
2.7.4

