From 61ea854f549b20d53f682faacc91f8ba0b45e2ef Mon Sep 17 00:00:00 2001
From: Lorenzo Colitti <lorenzo@google.com>
Date: Fri, 15 Aug 2014 17:54:06 +0900
Subject: [PATCH 1/3] Fix DoS vulnerability in DHO_OPTIONSOVERLOADED.

Bug: 16677003
Change-Id: I6ac3318c04fa99d964e15aa2f06a5794daf61c7e
(cherry picked from commit eae50520f9880b7ffc25a22f39df8013c34768bc)
---
 dhcp.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/dhcp.c b/dhcp.c
index c22e767..53f4795 100644
--- a/dhcp.c
+++ b/dhcp.c
@@ -352,7 +352,7 @@ get_option(const struct dhcp_message *dhcp, uint8_t opt, int *len, int *type)
 		case DHO_OPTIONSOVERLOADED:
 			/* Ensure we only get this option once */
 			if (!overl)
-				overl = p[1];
+				overl = 0x80 | p[1];
 			break;
 		}
 		l = *p++;
-- 
2.7.4

